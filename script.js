const tableBody=document.getElementById('table-body');const fetchBtn=document.getElementById('parse-btn');const searchInput=document.getElementById('search-input');const searchBtn=document.getElementById('search-btn');const positionWiseBtn=document.getElementById('position-wise-btn');const loadingPopup=document.getElementById('loading-popup');const notification=document.getElementById('notification');let dataArr=[];let originalData=[];fetchBtn.addEventListener('click',()=>{loadingPopup.style.display='block';const xhr=new XMLHttpRequest();xhr.open('GET','Data/GAT Result 2024 Postgraduate Test 1.xlsx',!0);xhr.responseType='arraybuffer';xhr.onload=()=>{if(xhr.status===200){const data=new Uint8Array(xhr.response);const workbook=XLSX.read(data,{type:'array'});const sheetName=workbook.SheetNames[0];const worksheet=workbook.Sheets[sheetName];dataArr=XLSX.utils.sheet_to_json(worksheet,{header:['Sr.#','Roll #','CNIC','Name','Discipline','Marks']});originalData=[...dataArr];loadingPopup.style.display='none';displayData(dataArr)}};xhr.send()});function displayData(data){tableBody.innerHTML='';data.forEach((row,index)=>{const tr=document.createElement('tr');tr.innerHTML=`
      <td>${index + 1}</td>
      <td>${row['Roll #']}</td>
      <td>${row['CNIC']}</td>
      <td>${row['Name']}</td>
      <td>${row['Discipline']}</td>
      <td>${row['Marks']}</td>
    `;tableBody.appendChild(tr)})}
let currentData=dataArr;searchBtn.addEventListener('click',()=>{loadingPopup.style.display='block';const searchTerm=searchInput.value.trim().toLowerCase();let filteredData;if(searchTerm==='chemistry'){filteredData=dataArr.filter((row)=>row.Discipline.toLowerCase()==='chemistry')}else if(searchTerm.includes('biochem')){filteredData=dataArr.filter((row)=>row.Discipline.toLowerCase()==='biochemistry')}else{filteredData=dataArr.filter((row)=>row.Discipline.toLowerCase().includes(searchTerm))}
currentData=filteredData;loadingPopup.style.display='none';displayData(currentData)});positionWiseBtn.addEventListener('click',()=>{loadingPopup.style.display='block';currentData.sort((a,b)=>b.Marks-a.Marks);loadingPopup.style.display='none';displayData(currentData)})